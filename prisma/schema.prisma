datasource db {
  provider = "postgresql"
}

generator client {
  provider = "prisma-client-js"
}





model User {
  id            String   @id @default(uuid())
  email         String   @unique
  passwordHash  String
  companyName   String
  role          UserRole
  approved      Boolean  @default(false)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

model Region {
  id    String @id @default(uuid())
  code  String @unique
  name  String

  systemPrices SystemPrice[]
  extraPrices  ExtraPrice[]
}


model System {
  id                     String   @id @default(uuid())
  brand                  String
  model                  String   @unique
  systemType             SystemType
  tankMaterial           TankMaterial
  capacityLitres         Int
  warrantyPrimaryYears   Int
  warrantySecondaryYears Int?
  notes                  String?
  active                 Boolean  @default(true)
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt

  systemPrices           SystemPrice[]
}



model SystemPrice {
  id       String @id @default(uuid())
  system   System @relation(fields: [systemId], references: [id])
  systemId String
  region   Region @relation(fields: [regionId], references: [id])
  regionId String
  price    Decimal
}

model Extra {
  id         String    @id @default(uuid())
  code       String    @unique
  name       String
  systemType ExtraSystemType
  notes      String?
  active     Boolean   @default(true)

  prices     ExtraPrice[]
}

model ExtraPrice {
  id       String @id @default(uuid())
  extra    Extra  @relation(fields: [extraId], references: [id])
  extraId String
  region   Region @relation(fields: [regionId], references: [id])
  regionId String
  price    Decimal
}


enum UserRole {
  admin
  insurer
}
enum SystemType {
  electric
  heat_pump
  solar_thermosiphon
  solar_split
}

enum TankMaterial {
  mild_steel
  stainless_steel
}
enum ExtraSystemType {
  electric
  heat_pump
  solar
  all
}
